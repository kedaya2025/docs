---
title: "风险控制概览"
description: "全面的风险管理工具，提供账户级和自定义风险控制功能"
---

## 模块简介

风险控制模块是 TraderCopilot 的核心安全保障工具，提供多层次的风险管理功能。该模块能够实时监控账户状态，在达到预设风险条件时自动执行平仓操作，有效保护交易资金安全。

## 主要功能

<CardGroup cols={2}>
  <Card title="账户级风险管理" icon="shield-check">
    基于总浮盈、总浮亏、净值、余额的全账户风险控制
  </Card>
  <Card title="自定义风险管理" icon="sliders">
    按魔术号或货币对进行精细化的风险控制
  </Card>
  <Card title="定时平仓功能" icon="clock">
    每日定时自动平仓，支持精确的时间控制
  </Card>
  <Card title="实时监控系统" icon="eye">
    24小时实时监控，满足条件立即执行保护措施
  </Card>
</CardGroup>

## 风险控制层次

风险控制模块采用多层次的保护机制：

### 第一层：账户级保护
- **全局监控**: 监控整个账户的风险状况
- **即时响应**: 达到风险阈值立即全部平仓
- **四重保护**: 浮盈、浮亏、净值、余额四个维度

### 第二层：分组保护
- **精细控制**: 按魔术号或货币对分组管理
- **独立监控**: 每个分组独立计算风险
- **灵活配置**: 可选择不同的分组方式

### 第三层：时间保护
- **定时执行**: 每日固定时间自动平仓
- **强制保护**: 无论盈亏状况如何都执行平仓
- **风险隔离**: 避免隔夜风险和周末风险

## 快速使用

<Steps>
  <Step title="打开风险控制">
    在主控制面板中点击"风险"按钮，或使用快捷键 Ctrl+R
  </Step>
  <Step title="设置账户保护">
    在"账户管理"区域设置浮盈、浮亏、净值、余额的保护阈值
  </Step>
  <Step title="配置自定义保护">
    选择魔术号或货币对模式，添加需要保护的项目
  </Step>
  <Step title="启用监控">
    勾选相应的复选框启用风险监控功能
  </Step>
</Steps>

## 核心特性

### 智能风险计算

系统会自动计算风险参数的相对比例：

$$
\text{风险比例} = \frac{\text{设定值}}{\text{账户余额}} \times 100\%
$$

这样可以直观地了解风险设置相对于账户规模的比例。

### 实时监控机制

风险控制系统通过定时器实时监控：

```cpp
void OnTimer() {
    // 检查账户级风险条件
    if (满足风险条件) {
        执行全部平仓();
    }
    
    // 检查自定义风险条件
    if (满足分组风险条件) {
        执行分组平仓();
    }
    
    // 检查定时平仓条件
    if (到达设定时间) {
        执行定时平仓();
    }
}
```

### 多重平仓保护

当触发风险条件时，系统会执行完整的平仓操作：

- **关闭持仓**: 平仓所有市价持仓
- **删除挂单**: 删除所有待执行的挂单
- **即时执行**: 无延迟立即执行保护措施

## 风险控制类型

### 账户级风险控制

<CardGroup cols={2}>
  <Card title="总浮盈控制" icon="trending-up">
    **触发条件**: 总浮盈 > 设定值
    
    **保护目的**: 锁定利润，防止回撤
    
    **适用场景**: 达到盈利目标时保护收益
  </Card>
  
  <Card title="总浮亏控制" icon="trending-down">
    **触发条件**: 总浮亏 < 设定值
    
    **保护目的**: 限制损失，控制风险
    
    **适用场景**: 防止过度亏损
  </Card>
  
  <Card title="净值控制" icon="chart-line">
    **触发条件**: 账户净值 > 设定值
    
    **保护目的**: 基于净值的综合保护
    
    **适用场景**: 综合考虑浮盈浮亏的保护
  </Card>
  
  <Card title="余额控制" icon="wallet">
    **触发条件**: 账户余额 > 设定值
    
    **保护目的**: 基于实际余额的保护
    
    **适用场景**: 余额达到目标时的保护
  </Card>
</CardGroup>

### 自定义风险控制

#### 魔术号模式
- **分组方式**: 按EA的魔术号分组
- **监控范围**: 每个魔术号的独立盈亏
- **适用场景**: 多策略运行时的独立风险控制

#### 货币对模式
- **分组方式**: 按交易的货币对分组
- **监控范围**: 每个货币对的独立盈亏
- **适用场景**: 分散投资时的品种风险控制

### 定时平仓功能

#### 时间设置
- **格式**: HH:MM（24小时制）
- **精度**: 分钟级精度
- **执行窗口**: 设定时间的2秒内

#### 应用场景
- **日内交易**: 每日收盘前强制平仓
- **风险隔离**: 避免隔夜持仓风险
- **策略限制**: 限制交易时间范围

## 默认参数设置

系统提供合理的默认参数：

| 参数类型 | 默认值 | 说明 |
|----------|--------|------|
| **账户浮盈** | 500 | 货币单位，可根据账户规模调整 |
| **账户浮亏** | -500 | 货币单位，负值表示亏损 |
| **净值保护** | 1000 | 货币单位，综合保护阈值 |
| **余额保护** | 50000 | 货币单位，余额目标值 |
| **自定义浮盈** | 500 | 分组浮盈保护阈值 |
| **自定义浮亏** | -500 | 分组浮亏保护阈值 |
| **定时时间** | 20:30 | 默认晚上8:30平仓 |

## 适用场景

<Accordion title="新手交易者">
使用账户级风险控制，设置简单的浮盈浮亏保护，避免过度交易和情绪化决策
</Accordion>

<Accordion title="多策略交易">
使用魔术号模式，为不同的EA策略设置独立的风险控制参数
</Accordion>

<Accordion title="分散投资">
使用货币对模式，控制每个交易品种的风险敞口
</Accordion>

<Accordion title="日内交易">
使用定时平仓功能，确保每日收盘前清空所有持仓
</Accordion>

<Accordion title="风险管理">
综合使用多种风险控制方式，建立完整的风险管理体系
</Accordion>

## 注意事项

<Warning>
**重要安全提醒**
- 风险控制参数一旦设置，系统会严格执行
- 平仓操作不可撤销，请谨慎设置参数
- 建议先在模拟账户中测试风险控制功能
- 定期检查和调整风险控制参数
</Warning>

<Info>
**使用建议**
- 根据账户规模合理设置风险参数
- 不同策略使用不同的魔术号便于管理
- 定时平仓时间应避开重要新闻发布时段
- 定期备份风险控制设置
</Info>

## 模块文档

<CardGroup cols={2}>
  <Card title="账户风险管理" href="/modules/risk/account-risk">
    账户级风险控制的详细配置和使用方法
  </Card>
  <Card title="自定义风险管理" href="/modules/risk/custom-risk">
    魔术号和货币对的精细化风险控制
  </Card>
  <Card title="定时平仓功能" href="/modules/risk/scheduled-close">
    定时平仓的配置和应用场景
  </Card>
  <Card title="界面操作指南" href="/modules/risk/interface">
    风险控制界面的详细操作说明
  </Card>
  <Card title="问题解决" href="/modules/risk/troubleshooting">
    常见问题和解决方案
  </Card>
</CardGroup>
